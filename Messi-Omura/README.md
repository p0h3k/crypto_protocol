Изначально протокол Мэсси-Омуры был описан применительно к мультипликативной группе Z p ∗ {\displaystyle Z_{p}^{*}}, где p p — простое число, и представлял собой аналог передачи секрета с помощью запираемых на один или два замка ящиков. Суть схемы заключается в следующем: абонент Alice запирает ящик с письмом своим ключом и пересылает ящик абоненту Bob. Абонент Bob, в свою очередь, запирает его своим ключом, и отправляет обратно к Alice. Alice снимает свой замок и направляет ящик к Bob, который снимает свой замок.
Алгоритм

    Выбирается в качестве системного параметра большое простое число p p. Абоненты Alice и Bob выбирают случайные числа e A e_{A} и e B e_{B} (между 0 и p − 1 p-1), взаимно простые с p − 1 = φ ( p ) p-1=\varphi (p), где φ \varphi  — функция Эйлера.
    С помощью расширенного алгоритма Евклида вычисляются d A d_{A} и d B d_{B}, обратные числам e A e_{A} и e B e_{B} по модулю p − 1 p-1:

        d A = e A − 1 mod ( p − 1 ) {\displaystyle d_{A}={e_{A}}^{-1}{\bmod {(}}p-1)}
        d B = e B − 1 mod ( p − 1 ) {\displaystyle d_{B}={e_{B}}^{-1}{\bmod {(}}p-1)}

    Иначе говоря, должны выполняться условия:

        e A ⋅ d A ≡ 1 mod ( p − 1 ) {\displaystyle e_{A}\cdot {d_{A}\equiv 1{\bmod {(}}p-1)}},
        e B ⋅ d B ≡ 1 mod ( p − 1 ) {\displaystyle e_{B}\cdot {d_{B}}\equiv 1{\bmod {(}}p-1)}.

Пары чисел ( e A , d A ) {\displaystyle (e_{A},d_{A})}, ( e B , d B ) (e_{B},d_{B}) являются секретными ключами абонентов.

        m e A ⋅ d A = m mod p {\displaystyle m^{e_{A}\cdot {d_{A}}}=m{\bmod {p}}}, так как
        m e A ⋅ d A = m j ⋅ φ ( p ) + 1 = m j ⋅ φ ( p ) ⋅ m = m m^{{e_{A}\cdot {d_{A}}}}=m^{{j\cdot {\varphi (p)+1}}}=m^{{j\cdot {\varphi (p)}}}\cdot {m}=m

(Первый сомножитель равен 1 по теореме Эйлера). Аналогично m e B d B = m mod p {\displaystyle m^{e_{B}d_{B}}=m{\bmod {p}}}.

    Абонент Alice посылает сообщение m m ( 0 < m < p − 1 0<m<{p-1}) абоненту Bob.

Alice шифрует своё сообщение первым ключом: m 1 = m e A mod p {\displaystyle m_{1}=m^{e_{A}}{\bmod {p}}} ( 0 < m 1 < p 0<m_{1}<p) и пересылает m 1 m_1 абоненту Bob.

    Bob шифрует вторым ключом: m 2 = m 1 e B mod p m_{2}=m_{1}^{{e_{B}}}{\bmod p} ( 0 < m 2 < p {\displaystyle 0<m_{2}<p}) и пересылает обратно к Аlice.
    Alice «снимает первый замок» с помощью второго секретного ключа:

        m 3 = m 2 d A mod p = m e A ⋅ e B ⋅ d A mod p m_{3}=m_{2}^{{d_{A}}}{\bmod p}=m^{{e_{A}\cdot {e_{B}}\cdot {d_{A}}}}{\bmod p}.

    Bob «снимает свой первый замок» с помощью второго секретного ключа:

        m 4 = m 3 d B mod p = m d B ⋅ e A ⋅ e B ⋅ d A m o d p = m m_{4}=m_{3}^{{d_{B}}}{\bmod p}=m^{{d_{B}\cdot {e_{A}}\cdot {e_{B}}\cdot {d_{A}}}}modp=m

Итого: абоненту Bob доставлено секретное сообщение m m от Аlice. 
